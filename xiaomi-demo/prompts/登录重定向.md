增加页面权限控制，流程如下：
1、打开页面http://localhost:3000/invoice-requests前，先判断当前redis存储的session是否存在登录信息，需要检查登录信息中domain字段是否和地址栏的query参数domain是否相同，地址栏如果不存在domain，则提取sessionStorage里面的domain，如果都没有则使用默认值kingdee进行和session中比较。如果能匹配成功则表示已经登录正常进入界面。
2、如果第一步session中没有登录信息或者domain不匹配，则认为没有登录，需要生成单点登录地址
3、单点登录地址生成需要通过"根据域名获取租户信息"先获取一些信息, 获取到信息后生成重定向到以下路径：${url}/auth/authorize.do?app_client_id=${clientId}&response_code=code&redirect_uri=encodeURIComponent(${当前页面地址}?formId=pc_main_console&app_client_id=${clientId}&response_code=code)
4、当用户完成登录后将会重定向到第3步的当前页面地址，并在地址栏携带response_code，获取到该信息后，需要调用"苍穹SSO登录"接口完成获取登录信息，获取到登录信息后将domain、苍穹SSO用户信息全部保存到redis session中
5、接口文档中的请求地址完整路径为：https://api-sit.piaozone.com/xm-demo${path}, 其中"https://api-sit.piaozone.com"为环境变量NEXT_PUBLIC_API_URL对应的值
6、根据域名获取租户信息接口文档：
# 根据域名获取租户信息

## OpenAPI Specification

```yaml
openapi: 3.0.1
info:
  title: ''
  description: ''
  version: 1.0.0
paths:
  /api/tenant-info/domain/{domain}:
    get:
      summary: 根据域名获取租户信息
      deprecated: false
      description: 通过域名查询对应的租户SSO配置信息，返回时会隐藏敏感的clientSecret字段
      tags:
        - TenantInfo
      parameters:
        - name: domain
          in: path
          description: 租户域名
          required: true
          example: ''
          schema:
            type: string
            example: feature.kingdee.com
        - name: Accept-Language
          in: header
          description: 语言设置
          required: false
          example: ''
          schema:
            type: string
            enum:
              - zh-CN
              - en-US
            default: en-US
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantInfoResponse'
          headers: {}
          x-apifox-name: 成功
        '404':
          description: 租户信息不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
          headers: {}
          x-apifox-name: 记录不存在
        '500':
          description: 查询失败
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
          headers: {}
          x-apifox-name: 服务器错误
      security: []
      x-apifox-folder: TenantInfo
      x-apifox-status: released
      x-run-in-apifox: https://app.apifox.com/web/project/6934009/apis/api-344642476-run
components:
  schemas:
    TenantInfoResponse:
      type: object
      properties:
        errcode:
          type: string
          description: 响应码
          example: '200'
        message:
          type: string
          description: 响应消息
          example: Success
        data:
          $ref: '#/components/schemas/TenantInfo'
      x-apifox-orders:
        - errcode
        - message
        - data
      x-apifox-ignore-properties: []
      x-apifox-folder: ''
    TenantInfo:
      type: object
      description: 租户SSO配置信息
      properties:
        id:
          type: integer
          format: int64
          description: 租户ID
          example: 1
        tenantType:
          type: integer
          description: 租户类型：1=苍穹，99=其他
          enum:
            - 1
            - 99
          example: 1
        url:
          type: string
          description: SSO单点登录域名URL
          example: https://feature.kingdee.com:1026/devscm/kapi
        clientId:
          type: string
          description: 第三方应用ID
          example: ssotest
        clientSecret:
          type: string
          description: 第三方应用秘钥（查询时会被隐藏）
          example: 4ef47846!e875%4582zZ*a066
        username:
          type: string
          description: 第三方单点登录用户名
          example: james_test
        accountId:
          type: string
          description: 第三方数据中心ID
          example: '1163729932103190528'
        domain:
          type: string
          description: 对应的租户域名
          example: feature.kingdee.com
        active:
          type: integer
          description: 启用状态：1=启用，0=禁用
          enum:
            - 0
            - 1
          example: 1
        createTime:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-09-02T10:00:00'
        updateTime:
          type: string
          format: date-time
          description: 更新时间
          example: '2025-09-02T10:00:00'
      x-apifox-orders:
        - id
        - tenantType
        - url
        - clientId
        - clientSecret
        - username
        - accountId
        - domain
        - active
        - createTime
        - updateTime
      x-apifox-ignore-properties: []
      x-apifox-folder: ''
    ErrorResponse:
      type: object
      properties:
        errcode:
          type: string
          description: 错误码
          example: '500'
        message:
          type: string
          description: 错误消息
          example: Tenant not found
        data:
          type: object
          x-apifox-orders: []
          properties: {}
          x-apifox-ignore-properties: []
          nullable: true
          example: null
      x-apifox-orders:
        - errcode
        - message
        - data
      x-apifox-ignore-properties: []
      x-apifox-folder: ''
  securitySchemes: {}
servers:
  - url: http://api-sit.piaozone.com/xm-demo
    description: 测试环境
security: []

```
7、"苍穹SSO登录"接口文档
# 苍穹SSO登录

## OpenAPI Specification

```yaml
openapi: 3.0.1
info:
  title: ''
  description: ''
  version: 1.0.0
paths:
  /api/sso/kingdee/login:
    post:
      summary: 苍穹SSO登录
      deprecated: false
      description: 通过苍穹SSO进行单点登录，获取用户信息和访问令牌。需要前端先完成苍穹SSO认证获得code参数。
      tags:
        - SSO
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SsoLoginRequest'
        required: true
      responses:
        '200':
          description: 登录成功或失败
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/SsoLoginSuccessResponse'
                  - $ref: '#/components/schemas/SsoErrorResponse'
          headers: {}
          x-apifox-name: 成功
      security: []
      x-apifox-folder: SSO
      x-apifox-status: released
      x-run-in-apifox: https://app.apifox.com/web/project/6934009/apis/api-344643020-run
components:
  schemas:
    SsoLoginRequest:
      type: object
      required:
        - domain
        - code
      properties:
        domain:
          type: string
          description: 租户域名
          example: feature.kingdee.com
        code:
          type: string
          description: 前端单点登录成功后获得的授权码
          example: mjc5J75ada4uK18I67LC7ME2RBwAhRa2uYeJI7qm8Nk2m5DZYM24A8HuYv5PRUPJ
        nonce:
          type: string
          description: 随机数，用于防重放攻击（可选，系统会自动生成）
          example: 52878291-2b8f-4e74-9bfd-bd19bc9b18f4
        language:
          type: string
          description: 语言设置，如 zh_CN、en_US（可选，系统会自动检测）
          enum:
            - zh_CN
            - en_US
          example: zh_CN
      x-apifox-orders:
        - domain
        - code
        - nonce
        - language
      x-apifox-ignore-properties: []
      x-apifox-folder: ''
    SsoLoginSuccessResponse:
      type: object
      properties:
        errcode:
          type: string
          description: 响应码
          example: '200'
        message:
          type: string
          description: 响应消息
          example: 登录成功
        data:
          $ref: '#/components/schemas/KingdeeSsoUserInfo'
      x-apifox-orders:
        - errcode
        - message
        - data
      x-apifox-ignore-properties: []
      x-apifox-folder: ''
    SsoErrorResponse:
      type: object
      properties:
        errcode:
          type: string
          description: 错误码
          example: '500'
        message:
          type: string
          description: 错误消息，包含具体的异常描述
          example: 'SSO登录失败: 获取苍穹SSO用户信息失败'
        data:
          type: object
          x-apifox-orders: []
          properties: {}
          x-apifox-ignore-properties: []
          nullable: true
          example: null
      x-apifox-orders:
        - errcode
        - message
        - data
      x-apifox-ignore-properties: []
      x-apifox-folder: ''
    KingdeeSsoUserInfo:
      type: object
      description: 苍穹SSO用户信息
      properties:
        userId:
          type: string
          description: 用户ID
          example: null
        username:
          type: string
          description: 用户名
          example: james_test
        displayName:
          type: string
          description: 用户显示名称
          example: James Test User
        email:
          type: string
          description: 邮箱
          example: james@test.com
        mobile:
          type: string
          description: 手机号
          example: '13800138000'
        accountId:
          type: string
          description: 数据中心ID
          example: '1163729932103190528'
        tenantId:
          type: string
          description: 租户ID
          example: null
        language:
          type: string
          description: 语言
          example: zh_CN
        accessToken:
          type: string
          description: 访问令牌
          example: OPENAPIAUTH_xxxxxxxxxxxxxxxxxx
        tokenType:
          type: string
          description: 令牌类型
          example: Bearer
        expiresIn:
          type: integer
          format: int64
          description: 令牌过期时间（秒）
          example: 7199989
        realUsername:
          type: string
          description: 真实用户名（从苍穹API获取）
          example: james_test
        workNumber:
          type: string
          description: 工号
          example: '001'
      x-apifox-orders:
        - userId
        - username
        - displayName
        - email
        - mobile
        - accountId
        - tenantId
        - language
        - accessToken
        - tokenType
        - expiresIn
        - realUsername
        - workNumber
      x-apifox-ignore-properties: []
      x-apifox-folder: ''
  securitySchemes: {}
servers:
  - url: http://api-sit.piaozone.com/xm-demo
    description: 测试环境
security: []

```
